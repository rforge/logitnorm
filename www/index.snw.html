<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
Use the following R commands to sweave this file:
library(R2HTML)
Sweave("index.snw.html",driver=RweaveHTML())
A <- readLines(file("index.snw.html.html"))
A1 <- gsub("(<!-- begin\\{Sinput} !--.)",'\\1 <div class="Sinput">',A)
A2 <- gsub("(<!--[ \\]*end\\{Sinput}.?!--.)",'</div> \\1',A1)
writeLines(con=file("index.html"), text=A2)
!-->	

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en   ">

  <head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>logitnorm</title>
	<!-- obscures tables link rel="stylesheet" type="text/css" href="https://r-forge.r-project.org/themes/rforge/css/theme.css" /-->
	<link href="Rforge_theme.css" rel="stylesheet" type="text/css">
	<link href="R2HTML.css" rel="stylesheet" type="text/css">
  </head>

<body>
	
<h1>logitnorm</h1>	

Utilities for the <a href="http://en.wikipedia.org/wiki/Logitnormal">logitnormal distribution</a> in <a href="http://www.r-project.org/">R</a>

<ul>
<li>Density, distribution, quantile and random generation function.</li>
<li>Estimation of the mode and the first two moments.</li>
<li>Estimation of distribution parameters.</li> 
</ul>

<h2>Download/Install</h2>

<ul><li>from <a href="https://r-forge.r-project.org/R/?group_id=886">download page</a> on R-Forge</li>
<li>To install this package directly within R type: 
   <strong><code>install.packages("logitnorm", repos="http://R-Forge.R-project.org")</code></strong>
</li>
</ul>

<h2>Documentaion</h2>
The package comes with documentaion and examples. 
Within R type:
<<echo=TRUE,eval=FALSE>>=
library(logitnorm)
?logitnorm
@

<h2>Distribution</h2>
The logitnormal distribution is useful as a prior density for variables that are bounded
between 0 and 1, such as proportions. Fig. 1 displays its density for various combinations of 
parameters mu and sigma.

\SweaveOpts{keep.source=TRUE}

<<echo=FALSE,eval=TRUE>>=
library(logitnorm)
library(ggplot2)

xGrid = c(0+.Machine$double.eps,seq(0,1, length.out=81)[-c(1,81)],1-.Machine$double.eps)

#explore chanign sigma at mu=0
theta0 <- expand.grid(mu=seq(0,2,length.out=9), sigma=10^seq(-0.5,0.5,length.out=5))
n <- nrow(theta0)

.calcDensityGrid <- function(
	### Calculate lognormal desnity for given combinations
	theta0	##<< matrix with columns mu and sigma
	,xGrid = seq(0,1, length.out=81)[-c(1,81)]
){ 
	dx <- apply( theta0, 1, function(theta0i){
			dx <- dlogitnorm(xGrid, mu=theta0i[1], sigma=theta0i[2])
		})
	dimnames(dx) <- list(iX=NULL,iTheta=NULL)
	ds <- melt(dx)
	ds[1:10,]
	ds$mu <- rep(as.factor(round(theta0[,1],2)), each=length(xGrid))
	ds$sigma <- rep(as.factor(round(theta0[,2],2)), each=length(xGrid))
	ds$x <- rep(xGrid, nrow(theta0))
	ds
	### data frame with columns value,x,mu and sigma 
}
@

<<fig =TRUE , echo =FALSE, width=600,height=430, align=left, caption=Fig. 1 Density for for various combinations of mu and sigma. >>=
ds <- .calcDensityGrid(theta0,xGrid=xGrid)
print(qplot(xGrid,value,data=ds, geom="line", color=sigma, ylab="density")+ facet_wrap(~mu,scales="free")+opts(axis.title.x = theme_blank()))
@

<p>Example:
Plot the cumulative distribution 
</p>

<<fig =TRUE, echo =TRUE, width=250,height=200, align=left>>=
x <- seq(0,1, length.out=81)
d <- plogitnorm(x, mu=0.5, sigma=0.5)
plot(d~x,type="l")
@


<h2>Mean and Variance</h2>
The moments have no analytical solution. This package estimates them
by numerical integration:

<p>
Example:
estimate mean and standard deviation.
</p>

<<>>=
(theta <- momentsLogitnorm(mu=0.6,sigma=0.5))
@

<h2>Mode</h2>
The mode is found by setting derivatives to zero and optimizing
the resulting equation:

<br/><img src="modeEq.png" alt="logit(x) = \sigma^2(2x-1)+\mu" />


<p>
Example:
estimate the mode
</p>
<<>>=
# estimate the mode
(mle <- modeLogitnorm(mu=0.6,sigma=0.5))
@


<h2>Parameter Estimation</h2>
from upper quantile and
<ul>
<li>mode (Maximum Likelihood Estimate)</li>
<li>mean (Expected value)</li>
<li>median</li>
</ul>

<p>
Example:
estimate the parameters, with mode 0.7 and upper quantile 0.9
</p>

<<>>=
(theta <- twCoefLogitnormMLE(0.7,0.9))
@


<h2>References</h2>
<a href="http://www.economia.unimore.it/frederic_patrizio/Hidden/Papers/2008%20Frederic-Lad%20Comm%20Stat%20Revised.pdf">Frederic, P. & Lad, F. (2008)</a> 
Two Moments of the Logitnormal Distribution. 
<i>Communications in Statistics-Simulation and Computation</i>, 
37, 1263-1269

<p>Generated by sweave on: \Sexpr{format(Sys.time(),format="%Y-%m-%d")}.</p>  

<p> The <strong>project summary page</strong> you can find <a href="http://r-forge.r-project.org/projects/logitnorm/"><strong>here</strong></a>. </p>

</body>
</html>
